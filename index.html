HTML<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Stock Dashboard</title>
    <!-- Bootstrap CSS CDN for styling KPI cards -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-GLhlTQ8iRABdZLl6O3oVMWSktQOp6b7In1Zl3/Jr59b6EGGoI1aFkw7cmDA6j6gD" crossorigin="anonymous">
    <style>
        .kpi-card {
            text-align: center;
            padding: 20px;
            margin: 10px;
            border-radius: 10px;
            color: white;
        }
        .buy-card { background-color: #28a745; }
        .sell-card { background-color: #dc3545; }
        .exp-card { background-color: #ffc107; color: black; }
    </style>
</head>
<body>
    <div class="container">
        <h1 class="text-center my-4">Daily Stock Dashboard</h1>
        <div class="row">
            <div class="col-md-4">
                <div class="kpi-card buy-card">
                    <h4>Total Buy</h4>
                    <h2 id="total-buy">Loading...</h2>
                </div>
            </div>
            <div class="col-md-4">
                <div class="kpi-card sell-card">
                    <h4>Total Sell</h4>
                    <h2 id="total-sell">Loading...</h2>
                </div>
            </div>
            <div class="col-md-4">
                <div class="kpi-card exp-card">
                    <h4>Daily Expenditure</h4>
                    <h2 id="daily-exp">Not Available</h2>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Function to parse simple CSV (assumes no quoted fields with commas)
        function parseCSV(csv) {
            const lines = csv.trim().split('\n');
            const headers = lines[0].split(',');
            const data = lines.slice(1).map(line => line.split(','));
            return { headers, data };
        }

        // Function to sum a column by name
        function sumColumn(data, headers, columnName) {
            const colIndex = headers.indexOf(columnName);
            if (colIndex === -1) return 0;
            return data.reduce((sum, row) => {
                const value = parseFloat(row[colIndex]);
                return sum + (isNaN(value) ? 0 : value);
            }, 0);
        }

        // Buy Sheet URL (export as CSV - ensure the sheet is shared publicly or with link access)
        const buyUrl = 'https://docs.google.com/spreadsheets/d/12yHqIhFQZyEwYJlmBfscDmaXZpp2lXQK/export?format=csv&gid=752590382';

        // Sell Sheet URL (provided public CSV)
        const sellUrl = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vQkIpWAUgoPanUyc3qEyn1ZpsGcYHAStO9-MvJtO-0c8KjfdUllKNhktxg70cHpXw/pub?gid=1412337879&single=true&output=csv';

        // Fetch Buy data
        fetch(buyUrl)
            .then(response => {
                if (!response.ok) throw new Error('Failed to fetch Buy data. Ensure the sheet is publicly accessible.');
                return response.text();
            })
            .then(csv => {
                const { headers, data } = parseCSV(csv);
                const totalBuy = sumColumn(data, headers, 'Total_Cost');
                document.getElementById('total-buy').textContent = `$${totalBuy.toFixed(2)}`;
            })
            .catch(error => {
                console.error(error);
                document.getElementById('total-buy').textContent = 'Error loading data';
            });

        // Fetch Sell data
        fetch(sellUrl)
            .then(response => {
                if (!response.ok) throw new Error('Failed to fetch Sell data.');
                return response.text();
            })
            .then(csv => {
                const { headers, data } = parseCSV(csv);
                const totalSell = sumColumn(data, headers, 'Total_Cost_Sell');
                document.getElementById('total-sell').textContent = `$${totalSell.toFixed(2)}`;
            })
            .catch(error => {
                console.error(error);
                document.getElementById('total-sell').textContent = 'Error loading data';
            });

        // For Daily Expenditure: No source provided, so left as placeholder.
        // If you have a source, you can add a similar fetch here and update #daily-exp.
    </script>

    <!-- Bootstrap JS CDN (optional, for any interactive elements) -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js" integrity="sha384-w76AqPfDkMBDXo30jS1Sgez6pr3x5MlQ1ZAGC+nuZB+EYdgRZgiwxhTBTkF7CXvN" crossorigin="anonymous"></script>
</body>
</html>
